<!-- Note: this html script must be loaded from a server -->
<html>
    <head>
        <title>StudiCluster Banner</title>
        <meta name="viewport" content="height=80, initial-scale=1, user-scalable=no">
        
        <script type='text/javascript'>
            (function () {
                var useSSL = 'https:' == document.location.protocol;
                var src = (useSSL ? 'https:' : 'http:') +
                '//www.googletagservices.com/tag/js/gpt.js';
                document.write('<scr' + 'ipt src="' + src + '"></scr' + 'ipt>');
            })();
        </script>
 
        <script type='text/javascript'>
            googletag.defineSlot('/14148428/WP_Test_Tag', [320, 50], 'div-gpt-ad-1379275582111-0').addService(googletag.pubads());
            googletag.pubads().enableSyncRendering();
            googletag.pubads().enableSingleRequest();
            googletag.enableServices();
        </script>
    </head>
    <body style="margin: 0">
        <!-- WP_Test_Tag -->
        <div id='div-gpt-ad-1379275582111-0' style='width:320px; height:50px;'>
        
        </div>
        <script type='text/javascript'>
            (function () {
                "use strict";

                window.googletag = window.googletag || {};
                window.googletag.cmd = window.googletag.cmd || [];

                googletag.cmd.push(function () {

                    if (googletag.hasOwnProperty("on") || googletag.hasOwnProperty("off") || googletag.hasOwnProperty("trigger") || googletag.hasOwnProperty("events"))
                        return;

                    var old_log = googletag.debug_log.log,
                            events = [],
                            addEvent = function (name, id, match) {
                                events.push({
                                    "name": name,
                                    "id": id,
                                    "match": match
                                });
                            };

                    addEvent("gpt-slot_rendered", 6, /Completed rendering ad for slot ([\/\w]*)/ig);

                    googletag.events = googletag.events || {};

                    googletag.on = function (events, op_arg0/*data*/, op_arg1/*callback*/) {
                        if (!op_arg0)
                            return this;

                        events = events.split(" ");

                        var data = op_arg1 ? op_arg0 : undefined,
                                callback = op_arg1 || op_arg0,
                                ei = 0, e = '';

                        callback.data = data;

                        for (e = events[ei = 0]; ei < events.length; e = events[++ei])
                            (this.events[e] = this.events[e] || []).push(callback);

                        return this;
                    };

                    googletag.trigger = function (event, parameters) {

                        if (!this.events[event] || this.events[event].length === 0)
                            return this;

                        var parameters = parameters || [],
                                fi = 0, f = this.events[event][fi];

                        for (fi, f; fi < this.events[event].length; f = this.events[event][++fi])
                            if (f.apply(this, [{ data: f.data }].concat(parameters)) === false)
                                break;

                        return this;
                    };

                    googletag.debug_log.log = function (level, message, service, slot, reference) {
                        if (!message && typeof (message.getMessageId()) !== 'number') return;

                        var args = Array.prototype.slice.call(arguments),
                                        e = 0;
                        for (e; e < events.length; e++)
                            if (events[e].id === message.getMessageId())
                                googletag.trigger(events[e].name, args);
                        return old_log.apply(this, arguments);
                    };
                });
            })();

            var retiesCount = 9;

            function checkStatus() {
                var elementes = document.getElementsByTagName('body');
                
                if (elementes == null || elementes.length == 0)
                    return;

                var body = elementes[0];

                if (body.childNodes.length > 2)
                    window.external.notify("ad_loaded");
                else if (retiesCount > 0) {
                    retiesCount--;
                    setTimeout(checkStatus, 500);
                }
            }

            googletag.on("gpt-slot_rendered", function (e, level, message, service, slot, reference) {
                setTimeout(checkStatus, 500);
            });
            googletag.display('div-gpt-ad-1379275582111-0');
        </script>
    </body>
</html>